<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FU ICPC - Tic-Tac-Toe</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #2d3748;
            /* bg-gray-800 */
        }

        .board-cell {
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }

        .board-cell:hover:not(.occupied) {
            transform: scale(1.05);
            background-color: #4a5568;
        }

        .x-symbol,
        .o-symbol {
            font-size: 5rem;
            line-height: 1;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pop-in 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .x-symbol {
            color: #63b3ed;
        }

        .o-symbol {
            color: #f6ad55;
        }

        .logo-glow {
            filter: drop-shadow(0 0 12px rgba(255, 255, 255, 0.1));
        }

        .modal {
            animation: fade-in 0.3s ease-out;
        }

        @keyframes pop-in {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes fade-in {
            0% {
                opacity: 0;
                transform: scale(0.95);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .btn {
            transition: all 0.2s ease-in-out;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }

        .winning-cell {
            animation: win-pulse 0.8s infinite alternate;
        }

        @keyframes win-pulse {
            0% {
                background-color: #4a5568;
            }

            100% {
                background-color: #4299e1;
            }
        }
    </style>
</head>

<body class="text-white flex items-center justify-center min-h-screen p-4">

    <a href="index.html"
        class="absolute top-4 left-4 btn bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-600">
        &larr; Back to Arcade
    </a>

    <div id="game-container"
        class="w-full max-w-md mx-auto bg-gray-900 rounded-2xl shadow-2xl p-6 sm:p-8 space-y-6 hidden">
        <div class="text-center">
            <img src="logo_noBG (1).png" alt="FU ICPC Community Logo" class="h-24 mx-auto mb-4 logo-glow">
            <h1 class="text-3xl sm:text-4xl font-bold text-white">Tic-Tac-Toe</h1>
            <p id="status-text" class="text-gray-400 mt-2 text-lg">Your turn to play!</p>
        </div>
        <div id="game-board" class="grid grid-cols-3 gap-3 sm:gap-4"></div>
        <button id="restart-button"
            class="w-full bg-blue-500 text-white font-bold py-3 px-4 rounded-lg text-lg hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 btn">Restart
            Game</button>
    </div>

    <div id="start-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 modal">
        <div class="bg-gray-900 rounded-2xl shadow-xl p-8 text-center max-w-sm mx-auto">
            <h2 class="text-3xl font-bold text-white mb-6">Who Starts First?</h2>
            <div class="flex flex-col space-y-4">
                <button id="player-start-btn"
                    class="w-full bg-blue-500 text-white font-bold py-3 px-4 rounded-lg text-lg hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 btn">I'll
                    Go First (X)</button>
                <button id="computer-start-btn"
                    class="w-full bg-orange-500 text-white font-bold py-3 px-4 rounded-lg text-lg hover:bg-orange-600 focus:outline-none focus:ring-4 focus:ring-orange-300 btn">Computer
                    Goes First (O)</button>
            </div>
        </div>
    </div>

    <div id="game-over-modal"
        class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 modal">
        <div class="bg-gray-900 rounded-2xl shadow-xl p-8 text-center max-w-sm mx-auto">
            <h2 id="modal-title" class="text-3xl font-bold text-white mb-4">Game Over!</h2>
            <p id="modal-message" class="text-gray-400 text-lg mb-6">You lost!</p>
            <button id="modal-restart-button"
                class="w-full bg-blue-500 text-white font-bold py-3 px-4 rounded-lg text-lg hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 btn">Play
                Again</button>
        </div>
    </div>

    <script>
        // JS Logic is unchanged and remains the same.
        document.addEventListener('DOMContentLoaded', () => {
            const boardElement = document.getElementById('game-board');
            const statusText = document.getElementById('status-text');
            const restartButton = document.getElementById('restart-button');
            const gameOverModal = document.getElementById('game-over-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modal-message');
            const modalRestartButton = document.getElementById('modal-restart-button');
            const startModal = document.getElementById('start-modal');
            const playerStartBtn = document.getElementById('player-start-btn');
            const computerStartBtn = document.getElementById('computer-start-btn');
            const gameContainer = document.getElementById('game-container');

            const PLAYER = 'X';
            const COMPUTER = 'O';
            let boardState = Array(9).fill(null);
            let isPlayerTurn = true;
            let isGameOver = false;

            const createBoard = () => {
                boardElement.innerHTML = '';
                boardState.forEach((_, index) => {
                    const cell = document.createElement('div');
                    cell.classList.add('board-cell', 'bg-gray-700', 'rounded-lg', 'h-24', 'sm:h-28', 'flex', 'items-center', 'justify-center', 'cursor-pointer');
                    cell.dataset.index = index;
                    cell.addEventListener('click', handleCellClick);
                    boardElement.appendChild(cell);
                });
            };

            const handleCellClick = (event) => {
                if (isGameOver || !isPlayerTurn) return;
                const index = event.target.dataset.index;
                if (boardState[index] === null) {
                    makeMove(index, PLAYER);
                    if (!isGameOver) {
                        isPlayerTurn = false;
                        statusText.textContent = "Computer's thinking...";
                        setTimeout(computerMove, 700);
                    }
                }
            };

            const makeMove = (index, player) => {
                if (boardState[index] !== null || isGameOver) return;
                boardState[index] = player;
                const cell = boardElement.children[index];
                cell.innerHTML = `<div class="${player === PLAYER ? 'x-symbol' : 'o-symbol'}">${player}</div>`;
                cell.classList.add('occupied', 'cursor-default');
                const winnerInfo = checkWinner(boardState);
                if (winnerInfo) {
                    isGameOver = true;
                    highlightWinningCells(winnerInfo.line);
                    setTimeout(() => showGameOverModal(winnerInfo.winner), 500);
                } else if (boardState.every(cell => cell !== null)) {
                    isGameOver = true;
                    setTimeout(() => showGameOverModal(null), 500);
                }
            };

            const computerMove = () => {
                if (isGameOver) return;
                const bestMoveIndex = findBestMove(boardState);
                makeMove(bestMoveIndex, COMPUTER);
                if (!isGameOver) {
                    isPlayerTurn = true;
                    statusText.textContent = "Your turn to play!";
                }
            };

            const checkWinner = (board) => {
                const winningCombos = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
                for (const line of winningCombos) {
                    const [a, b, c] = line;
                    if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                        return { winner: board[a], line };
                    }
                }
                return null;
            };

            const findBestMove = (currentBoard) => {
                let bestVal = -Infinity;
                let bestMove = -1;
                for (let i = 0; i < currentBoard.length; i++) {
                    if (currentBoard[i] === null) {
                        currentBoard[i] = COMPUTER;
                        let moveVal = minimax(currentBoard, 0, false);
                        currentBoard[i] = null;
                        if (moveVal > bestVal) {
                            bestMove = i;
                            bestVal = moveVal;
                        }
                    }
                }
                return bestMove;
            };

            const minimax = (board, depth, isMaximizing) => {
                const winnerInfo = checkWinner(board);
                if (winnerInfo) return winnerInfo.winner === COMPUTER ? 10 - depth : depth - 10;
                if (board.every(cell => cell !== null)) return 0;

                if (isMaximizing) {
                    let best = -Infinity;
                    for (let i = 0; i < board.length; i++) {
                        if (board[i] === null) {
                            board[i] = COMPUTER;
                            best = Math.max(best, minimax(board, depth + 1, false));
                            board[i] = null;
                        }
                    }
                    return best;
                } else {
                    let best = Infinity;
                    for (let i = 0; i < board.length; i++) {
                        if (board[i] === null) {
                            board[i] = PLAYER;
                            best = Math.min(best, minimax(board, depth + 1, true));
                            board[i] = null;
                        }
                    }
                    return best;
                }
            };

            const showGameOverModal = (winner) => {
                if (winner) {
                    modalTitle.textContent = winner === PLAYER ? "You Won!" : "You Lost!";
                    modalMessage.textContent = winner === COMPUTER ? "The computer is unbeatable. Better luck next time!" : "Somehow, you beat the unbeatable AI!";
                } else {
                    modalTitle.textContent = "It's a Draw!";
                    modalMessage.textContent = "You've managed to hold your ground against the AI.";
                }
                gameOverModal.classList.remove('hidden');
            };

            const highlightWinningCells = (line) => line.forEach(index => boardElement.children[index].classList.add('winning-cell'));

            const startGame = (playerStarts) => {
                isPlayerTurn = playerStarts;
                boardState = Array(9).fill(null);
                isGameOver = false;
                createBoard();
                startModal.classList.add('hidden');
                gameContainer.classList.remove('hidden');
                if (!playerStarts) {
                    statusText.textContent = "Computer's turn...";
                    setTimeout(computerMove, 700);
                } else {
                    statusText.textContent = 'Your turn to play!';
                }
            };

            const resetGame = () => {
                gameOverModal.classList.add('hidden');
                gameContainer.classList.add('hidden');
                startModal.classList.remove('hidden');
            };

            playerStartBtn.addEventListener('click', () => startGame(true));
            computerStartBtn.addEventListener('click', () => startGame(false));
            restartButton.addEventListener('click', resetGame);
            modalRestartButton.addEventListener('click', resetGame);
        });
    </script>
</body>

</html>